import{u as N,j as e,C as n,a as o,b as d,c as x,A as G,d as I,e as E,B as T,f as g,g as u,h as F,m as w}from"./index-B2j6MuZ4.js";import{r as i,L as p}from"./vendor-DvMla3zT.js";import{i as D,j as q,b as W,A as f,W as j,k as O,a as b,f as y,l as k,m as C,C as R,n as X,o as B}from"./ui-CRTwZCWL.js";import{x as H,P as U}from"./types-BWFGs213.js";/* empty css                */import{M as J,T as Q,b as V,l as Z}from"./maps-DK6RsE9k.js";const K={sighting:j,badge:f,level_up:f,mission:W,streak:q},A={sighting:"text-blue-500 bg-blue-100 dark:bg-blue-900/30",badge:"text-amber-500 bg-amber-100 dark:bg-amber-900/30",level_up:"text-purple-500 bg-purple-100 dark:bg-purple-900/30",mission:"text-green-500 bg-green-100 dark:bg-green-900/30",streak:"text-orange-500 bg-orange-100 dark:bg-orange-900/30"};function P(){const{profile:t}=N(),[a,r]=i.useState([]),[c,s]=i.useState("global"),[m,S]=i.useState(!0);i.useEffect(()=>{$()},[c,t]);const $=async()=>{S(!0);try{const h=await fetch(`/api/activity-feed${c==="following"?"?filter=following":""}`);h.ok&&r(await h.json())}catch(l){console.error("Failed to fetch activity",l)}finally{S(!1)}},_=l=>{const h=new Date(l),z=new Date().getTime()-h.getTime(),v=Math.floor(z/(1e3*60)),L=Math.floor(z/(1e3*60*60));return v<1?"Just now":v<60?`${v}m ago`:L<24?`${L}h ago`:h.toLocaleDateString()};return e.jsxs(n,{className:"h-full",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(d,{className:"text-lg flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Community Activity"]}),t&&e.jsxs("div",{className:"flex bg-muted rounded-lg p-1",children:[e.jsx("button",{onClick:()=>s("global"),className:`px-3 py-1 text-xs font-medium rounded-md transition-all ${c==="global"?"bg-background shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Global"}),e.jsx("button",{onClick:()=>s("following"),className:`px-3 py-1 text-xs font-medium rounded-md transition-all ${c==="following"?"bg-background shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Following"})]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto pr-2",children:m?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Loading updates..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:c==="following"?"No activity from people you follow yet. Follow more users!":"No recent activity."}):a.map(l=>{const h=K[l.type]||j,M=A[l.type]||A.sighting;return e.jsxs("div",{className:"flex gap-3 group",children:[e.jsx("div",{className:"mt-1",children:e.jsx(p,{to:`/profile/${l.user_id}`,children:e.jsxs(G,{className:"h-8 w-8 border-2 border-background shadow-sm",children:[e.jsx(I,{src:l.avatar_url||void 0}),e.jsx(E,{className:"text-xs",children:l.username?.[0]?.toUpperCase()})]})})}),e.jsxs("div",{className:"flex-1 min-w-0 pb-4 border-b last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(p,{to:`/profile/${l.user_id}`,className:"text-sm font-semibold hover:underline truncate",children:l.username}),e.jsx("span",{className:"text-[10px] text-muted-foreground whitespace-nowrap",children:_(l.created_at)})]}),e.jsxs("div",{className:"flex items-start gap-2 mt-1",children:[e.jsx("div",{className:`p-1 rounded-md shrink-0 ${M}`,children:e.jsx(h,{className:"h-3 w-3"})}),e.jsx("p",{className:"text-sm text-muted-foreground leading-snug",children:l.description})]}),l.xp_earned>0&&e.jsxs(T,{variant:"secondary",className:"mt-2 text-[10px] h-5 px-1.5",children:["+",l.xp_earned," XP"]})]})]},l.id)})})})]})}function Y(){const{profile:t}=N();if(!t)return null;const{current:a,required:r}=H(t.xp||0,t.level||1),c=Math.min(100,a/r*100);return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-extrabold bg-gradient-to-r from-primary to-blue-600 bg-clip-text text-transparent",children:["Welcome back, ",t.username||"Guardian","!"]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Ready to continue your ocean conservation journey?"})]}),e.jsxs("div",{className:"flex items-center gap-3 neo-flat px-6 py-2 rounded-full",children:[e.jsx(f,{className:"h-6 w-6 text-primary"}),e.jsxs("span",{className:"font-bold text-primary text-lg",children:["Level ",t.level||1]})]})]}),e.jsx(n,{variant:"neomorph",className:"p-1",children:e.jsxs(x,{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"flex justify-between text-sm font-bold mb-3 uppercase tracking-wider text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-4 w-4 text-yellow-500 fill-yellow-500"}),a," XP"]}),e.jsxs("span",{children:[r," XP to next level"]})]}),e.jsx("div",{className:"p-1 neo-pressed rounded-full",children:e.jsx(U,{value:c,className:"h-4 rounded-full bg-transparent"})})]})})]})}function ee(){const[t,a]=i.useState(null),[r,c]=i.useState(!0);return i.useEffect(()=>{fetch("/api/dashboard/stats").then(s=>s.ok?s.json():null).then(a).catch(s=>console.error("Failed to fetch stats",s)).finally(()=>c(!1))},[]),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 animate-pulse",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-muted rounded-xl"},s))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Sightings"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.totalSightings.toLocaleString()||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(y,{className:"inline h-3 w-3 text-secondary mr-1"}),"Verified reports"]})]})]}),e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Active Missions"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.activeMissions.toLocaleString()||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Join the cleanup efforts"})]})]}),e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Ocean Guardians"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.totalGuardians.toLocaleString()||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Community members"})]})]})]})}const se=t=>new Z.DivIcon({html:`<div style="font-size: 20px;">
    ${t==="coral"?"ü™∏":t==="wildlife"?"üê¢":t==="floating"?"üö¢":"üóëÔ∏è"}
  </div>`,className:"bg-transparent border-none",iconSize:[20,20],iconAnchor:[10,10]});function te(){const[t,a]=i.useState([]);return i.useEffect(()=>{fetch("/api/sightings?limit=20").then(r=>r.ok?r.json():[]).then(a).catch(()=>{})},[]),e.jsxs(n,{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs(o,{className:"pb-2",children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-primary"}),"Live Map"]}),e.jsx(g,{children:"Recent activity nearby"})]}),e.jsxs(x,{className:"p-0 flex-1 relative min-h-[300px]",children:[e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 z-[400] bg-white/90 dark:bg-black/80 backdrop-blur p-3 rounded-lg border shadow-sm flex justify-between items-center",children:[e.jsxs("div",{className:"text-xs font-medium",children:[t.length," recent sightings"]}),e.jsx(u,{size:"sm",variant:"ghost",className:"h-8 gap-1",asChild:!0,children:e.jsxs(p,{to:"/map",children:["Full Map ",e.jsx(C,{className:"h-3 w-3"})]})})]}),e.jsxs(J,{center:[14.5995,120.9842],zoom:10,zoomControl:!1,scrollWheelZoom:!1,dragging:!0,className:"w-full h-full",style:{background:"#e0f2fe"},children:[e.jsx(Q,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.map(r=>e.jsx(V,{position:[r.latitude,r.longitude],icon:se(r.type)},r.id))]})]})]})}function ae(){const[t,a]=i.useState([]),[r,c]=i.useState(!0);return i.useEffect(()=>{fetch("/api/missions?status=active&limit=5").then(s=>s.ok?s.json():[]).then(s=>s.length===0?fetch("/api/missions?status=upcoming&limit=5").then(m=>m.ok?m.json():[]):s).then(a).catch(console.error).finally(()=>c(!1))},[]),r?e.jsx("div",{className:"h-64 bg-muted animate-pulse rounded-xl"}):t.length===0?e.jsx(n,{className:"bg-muted/50 border-dashed",children:e.jsxs(x,{className:"flex flex-col items-center justify-center h-48 text-center p-6",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No active missions right now."}),e.jsx(u,{variant:"outline",asChild:!0,children:e.jsx(p,{to:"/missions/create",children:"Create a Mission"})})]})}):e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex overflow-x-auto pb-4 gap-4 snap-x snap-mandatory scrollbar-hide",children:[t.map(s=>e.jsxs(n,{className:"min-w-[300px] max-w-[300px] flex-shrink-0 snap-center flex flex-col h-full hover:shadow-md transition-shadow",children:[s.image_url?e.jsx("div",{className:"h-40 w-full overflow-hidden rounded-t-xl",children:e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"h-40 w-full bg-muted flex items-center justify-center rounded-t-xl",children:e.jsx(k,{className:"h-10 w-10 text-muted-foreground/50"})}),e.jsxs(o,{className:"p-4 pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(d,{className:"text-base line-clamp-1",children:s.title}),e.jsx(T,{variant:s.status==="active"?"default":"secondary",className:"text-[10px] px-1.5 py-0 h-5",children:s.status})]}),e.jsxs(g,{className:"flex items-center gap-1 text-xs",children:[e.jsx(k,{className:"h-3 w-3"})," ",s.location_name]})]}),e.jsxs(x,{className:"p-4 pt-0 flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(R,{className:"h-3 w-3"}),new Date(s.start_time).toLocaleDateString()]})]}),e.jsx(F,{className:"p-4 pt-0",children:e.jsx(u,{size:"sm",className:"w-full",asChild:!0,children:e.jsx(p,{to:`/missions/${s.id}`,children:"View Details"})})})]},s.id)),e.jsx(p,{to:"/missions",className:"min-w-[150px] flex-shrink-0 snap-center",children:e.jsx(n,{className:"h-full flex items-center justify-center bg-muted/30 hover:bg-muted/50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground p-6",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-background flex items-center justify-center shadow-sm",children:e.jsx(C,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-medium text-sm",children:"View All"})]})})})]})})}function re(){const{profile:t}=N(),[a,r]=i.useState(!1),[c,s]=i.useState(!0);return i.useEffect(()=>{t&&fetch("/api/learning/quiz/daily").then(m=>m.ok?m.json():null).then(m=>{m&&m.alreadyCompleted&&r(!0)}).catch(()=>{}).finally(()=>s(!1))},[t]),c?null:e.jsx(n,{className:`border-none shadow-md overflow-hidden ${a?"bg-green-50 dark:bg-green-950/20":"bg-gradient-to-br from-indigo-500 to-purple-600"}`,children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a?e.jsx(X,{className:"h-6 w-6 text-green-600 dark:text-green-400"}):e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(B,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:`text-lg font-bold ${a?"text-green-800 dark:text-green-300":"text-white"}`,children:a?"Daily Quiz Completed!":"Daily Ocean Quiz"})]}),e.jsx("p",{className:`text-sm ${a?"text-green-700 dark:text-green-400":"text-indigo-100"}`,children:a?"Great job! Come back tomorrow for more XP.":"Test your knowledge and earn 50 XP bonus!"})]}),!a&&e.jsx(u,{size:"sm",variant:"secondary",className:"whitespace-nowrap",asChild:!0,children:e.jsxs(p,{to:"/learning/quiz",children:["Start Quiz ",e.jsx(C,{className:"ml-1 h-3 w-3"})]})})]})})})}function xe(){const{profile:t}=N();return t?e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-20 md:pb-8",children:[e.jsx(Y,{}),e.jsx(ee,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"h-[400px]",children:e.jsx(te,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-primary"}),"Active Missions"]})}),e.jsx(ae,{})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(re,{}),e.jsx("div",{className:"h-[500px]",children:e.jsx(P,{})})]})]})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-20 md:pb-8",children:[e.jsxs("section",{className:"text-center py-12 md:py-20 relative overflow-hidden",children:[e.jsx(w.div,{animate:{rotate:[0,5,-5,0],scale:[1,1.05,.95,1]},transition:{duration:10,repeat:1/0,ease:"linear"},className:"absolute -top-20 -left-20 w-64 h-64 bg-primary/10 rounded-full blur-3xl pointer-events-none"}),e.jsx(w.div,{animate:{rotate:[0,-5,5,0],scale:[1,.95,1.05,1]},transition:{duration:12,repeat:1/0,ease:"linear"},className:"absolute -bottom-20 -right-20 w-64 h-64 bg-secondary/10 rounded-full blur-3xl pointer-events-none"}),e.jsx("div",{className:"inline-flex items-center justify-center p-4 neo-flat rounded-3xl mb-8",children:e.jsx(j,{className:"h-14 w-14 text-primary animate-liquid"})}),e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-primary via-secondary to-primary bg-clip-text text-transparent",children:"Welcome to OceanGuardian"}),e.jsx("p",{className:"text-xl md:text-2xl text-muted-foreground mb-8 max-w-2xl mx-auto",children:"The Pok√©mon GO of Ocean Conservation"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-8 max-w-3xl mx-auto",children:"Transform beach walks into heroic conservation quests. Log debris, track coral health, earn badges, and help protect our oceans‚Äîone sighting at a time."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[e.jsx(u,{size:"lg",variant:"neomorph-primary",className:"text-lg px-10 h-14",asChild:!0,children:e.jsxs("a",{href:"/map",children:[e.jsx(b,{className:"mr-2 h-5 w-5"}),"Explore Map"]})}),e.jsx(u,{size:"lg",variant:"neomorph",className:"text-lg px-10 h-14",children:"Get Started"})]})]}),e.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs(n,{variant:"neomorph",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-semibold uppercase tracking-wider text-muted-foreground",children:"Total Sightings"}),e.jsx("div",{className:"p-2 neo-pressed rounded-lg",children:e.jsx(b,{className:"h-4 w-4 text-primary"})})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-3xl font-bold",children:"2,847"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(y,{className:"inline h-3 w-3 text-secondary mr-1"}),"+12% from last week"]})]})]}),e.jsxs(n,{variant:"neomorph",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-semibold uppercase tracking-wider text-muted-foreground",children:"Active Missions"}),e.jsx("div",{className:"p-2 neo-pressed rounded-lg",children:e.jsx(f,{className:"h-4 w-4 text-primary"})})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-3xl font-bold",children:"12"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Join cleanup missions near you"})]})]}),e.jsxs(n,{variant:"neomorph",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-semibold uppercase tracking-wider text-muted-foreground",children:"Ocean Guardians"}),e.jsx("div",{className:"p-2 neo-pressed rounded-lg",children:e.jsx(j,{className:"h-4 w-4 text-primary"})})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-3xl font-bold",children:"1,243"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Community members making an impact"})]})]})]})}),e.jsx("div",{className:"lg:col-span-1 h-[500px]",children:e.jsx(P,{})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-center",children:"How It Works"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(n,{className:"border-2 hover:border-primary transition-colors",children:e.jsxs(o,{children:[e.jsx("div",{className:"h-12 w-12 bg-primary/10 rounded-lg flex items-center justify-center mb-4",children:e.jsx(b,{className:"h-6 w-6 text-primary"})}),e.jsx(d,{children:"Discover"}),e.jsx(g,{children:"Browse the interactive map to find sightings and cleanup missions near you"})]})}),e.jsx(n,{className:"border-2 hover:border-primary transition-colors",children:e.jsxs(o,{children:[e.jsx("div",{className:"h-12 w-12 bg-secondary/10 rounded-lg flex items-center justify-center mb-4",children:e.jsx(j,{className:"h-6 w-6 text-secondary"})}),e.jsx(d,{children:"Report"}),e.jsx(g,{children:"Log debris, wildlife, and coral health with GPS-tagged photos"})]})}),e.jsx(n,{className:"border-2 hover:border-primary transition-colors",children:e.jsxs(o,{children:[e.jsx("div",{className:"h-12 w-12 bg-accent/10 rounded-lg flex items-center justify-center mb-4",children:e.jsx(f,{className:"h-6 w-6 text-accent"})}),e.jsx(d,{children:"Level Up"}),e.jsx(g,{children:"Earn XP, unlock badges, and climb the leaderboard as you contribute"})]})}),e.jsx(n,{className:"border-2 hover:border-primary transition-colors",children:e.jsxs(o,{children:[e.jsx("div",{className:"h-12 w-12 bg-chart-3/10 rounded-lg flex items-center justify-center mb-4",children:e.jsx(y,{className:"h-6 w-6 text-chart-3"})}),e.jsx(d,{children:"Impact"}),e.jsx(g,{children:"Track your conservation impact and share your achievements"})]})})]})]}),e.jsxs("section",{className:"text-center py-16 glass-liquid border-none rounded-3xl relative overflow-hidden",children:[e.jsx(w.div,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute -top-32 -left-32 w-64 h-64 bg-primary/20 rounded-full blur-3xl pointer-events-none"}),e.jsx("h2",{className:"text-4xl font-bold mb-4 relative z-10",children:"Ready to Make a Difference?"}),e.jsx("p",{className:"text-xl text-muted-foreground mb-10 max-w-2xl mx-auto relative z-10",children:"Join thousands of ocean guardians protecting marine life and cleaning our beaches"}),e.jsx(u,{size:"lg",variant:"neomorph-primary",className:"text-xl px-12 h-16 relative z-10",asChild:!0,children:e.jsx("a",{href:"/login",children:"Get Started"})})]})]})}export{xe as default};
