import{j as e}from"./index-Fy2jmMwR.js";import{r as a,L as h}from"./vendor-DvMla3zT.js";import{V as b,ai as L,Q as A,X as F,m as R}from"./ui-BFD__GsY.js";import"./maps-DK6RsE9k.js";function P(){const[l,f]=a.useState([]),[r,g]=a.useState(0),[n,d]=a.useState(null),[j,p]=a.useState([]),[o,N]=a.useState(null),[y,w]=a.useState(!0),[c,x]=a.useState(!1),[v,S]=a.useState(0),[k,C]=a.useState(0),[q,Q]=a.useState(!1),[u,z]=a.useState(0);a.useEffect(()=>{B()},[]);const B=async()=>{try{const s=await(await fetch("/api/learning/quiz/daily")).json();s.questions&&(f(s.questions),Q(s.alreadyCompleted))}catch(t){console.error("Failed to load quiz",t)}finally{w(!1)}},E=t=>{n===null&&d(t)},O=()=>{if(n===null)return;const t=[...j,{questionId:l[r].id,selectedOptionIndex:n}];p(t),d(null),r<l.length-1?g(s=>s+1):$(t)},$=async t=>{x(!0);try{const i=await(await fetch("/api/learning/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:t})})).json();N(i.results),S(i.earnedXp),C(i.streak),z(i.streakBonus)}catch(s){console.error("Failed to submit quiz",s)}finally{x(!1)}};if(y)return e.jsx("div",{className:"p-8 text-center",children:"Loading quiz..."});if(q)return e.jsxs("div",{className:"max-w-md mx-auto mt-16 p-8 bg-white rounded-2xl shadow-lg text-center",children:[e.jsx("div",{className:"bg-green-100 p-4 rounded-full w-20 h-20 mx-auto flex items-center justify-center mb-6",children:e.jsx(b,{className:"h-10 w-10 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Quiz Completed!"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"You've already taken today's quiz. Come back tomorrow for new questions and to keep your streak alive!"}),e.jsxs(h,{to:"/learning",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 transition-colors",children:[e.jsx(L,{className:"mr-2 h-5 w-5"}),"Back to Learning Hub"]})]});if(o){const t=o.filter(s=>s.isCorrect).length;return e.jsx("div",{className:"max-w-2xl mx-auto mt-8 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"bg-blue-600 p-8 text-center text-white",children:[e.jsx(A,{className:"h-16 w-16 mx-auto mb-4 text-yellow-300"}),e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Quiz Complete!"}),e.jsxs("p",{className:"text-blue-100 text-lg",children:["You scored ",t,"/",l.length]})]}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-center space-x-8 mb-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"XP Earned"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["+",v]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Streak"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[e.jsx("p",{className:"text-3xl font-bold text-orange-500",children:k}),e.jsx("span",{className:"text-xl",children:"ðŸ”¥"})]})]}),u>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Streak Bonus"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["+",u]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 border-b pb-2",children:"Result Breakdown"}),o.map((s,i)=>e.jsxs("div",{className:`p-4 rounded-lg flex items-start space-x-3 ${s.isCorrect?"bg-green-50":"bg-red-50"}`,children:[e.jsx("div",{className:`mt-0.5 p-1 rounded-full ${s.isCorrect?"bg-green-200":"bg-red-200"}`,children:s.isCorrect?e.jsx(b,{className:"h-4 w-4 text-green-700"}):e.jsx(F,{className:"h-4 w-4 text-red-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 mb-1",children:l.find(I=>I.id===s.questionId)?.question}),e.jsx("p",{className:"text-sm text-gray-600",children:s.explanation})]})]},i))]}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx(h,{to:"/learning",className:"px-8 py-3 bg-gray-900 text-white rounded-full font-semibold hover:bg-gray-800 transition-colors",children:"Back to Dashboard"})})]})]})})}const m=l[r];return e.jsxs("div",{className:"max-w-2xl mx-auto mt-8 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-500 mb-2",children:[e.jsxs("span",{children:["Question ",r+1," of ",l.length]}),e.jsx("span",{children:l[r].category})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300 ease-out",style:{width:`${(r+1)/l.length*100}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:m.question}),e.jsx("div",{className:"space-y-3",children:m.options.map((t,s)=>e.jsx("button",{onClick:()=>E(s),className:`w-full text-left p-4 rounded-xl border-2 transition-all duration-200 ${n===s?"border-blue-500 bg-blue-50 text-blue-700 font-medium":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-6 h-6 rounded-full border-2 mr-3 flex items-center justify-center ${n===s?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:n===s&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),t]})},s))}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{onClick:O,disabled:n===null||c,className:`inline-flex items-center px-6 py-3 rounded-full font-semibold transition-all ${n===null?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 shadow-md hover:shadow-lg"}`,children:c?"Submitting...":e.jsxs(e.Fragment,{children:[r===l.length-1?"Finish Quiz":"Next Question",e.jsx(R,{className:"ml-2 h-5 w-5"})]})})})]})]})}export{P as default};
