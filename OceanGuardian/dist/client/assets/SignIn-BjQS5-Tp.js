import{k as I,j as e,m as g,d as _,f as A,g as O,h as T,C as B,Q as L,B as b,i as D}from"./index-w4qC22aZ.js";import{h as F,r as n,e as G}from"./vendor-tuWJg29S.js";import{I as x}from"./input-BK2Frxs7.js";import{W as U,a5 as f,a6 as W,a3 as M,a7 as Y,a8 as q,I as J,N as R,p as z}from"./ui-DmkW-1mw.js";import"./maps-D8oPmz78.js";function Z(){const[w]=F(),y=w.get("mode")||"signin",[o,j]=n.useState(""),[l,c]=n.useState(""),[u,v]=n.useState(""),[d,N]=n.useState(!1),[t,m]=n.useState(y),[i,r]=n.useState(!1),{toast:s}=I(),h=G(),C=async a=>{a.preventDefault(),r(!0);const k=t==="signup"?"/api/auth/signup":"/api/auth/login",P=t==="signup"?{email:o,password:l,username:u||void 0}:{email:o,password:l};try{const p=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(p.ok)s({title:t==="signup"?"Account Created!":"Welcome Back!",description:t==="signup"?"Your guardian account is ready.":"You have signed in successfully."}),h("/dashboard");else{const E=await p.json();s({title:"Error",description:E.error||"Something went wrong",variant:"destructive"})}}catch{s({title:"Error",description:"Connection failed. Please try again.",variant:"destructive"})}finally{r(!1)}},S=async()=>{r(!0);try{(await fetch("/api/auth/guest",{method:"POST"})).ok?(s({title:"Guest Session Started",description:"You're now browsing as a guest."}),h("/dashboard")):s({title:"Error",description:"Failed to start guest session.",variant:"destructive"})}catch{s({title:"Error",description:"Something went wrong.",variant:"destructive"})}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12 relative z-10",children:e.jsxs(g.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 shadow-[0_0_25px_rgba(6,182,212,0.4)] mb-6 animate-float-slow",children:e.jsx(U,{className:"h-10 w-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2 drop-shadow-lg text-center",children:t==="signin"?"Welcome Back":"Join Us"}),e.jsx("p",{className:"text-cyan-100/80 text-center text-lg",children:"Guardian"})]}),e.jsxs(_,{className:"bg-slate-900/40 backdrop-blur-xl border-white/10 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs(A,{className:"text-center pb-2",children:[e.jsx(O,{className:"text-xl font-semibold text-white",children:t==="signin"?"Sign In":"Create Account"}),e.jsx(T,{className:"text-slate-400",children:t==="signin"?"Enter your credentials to access your dashboard":"Set up your guardian account"})]}),e.jsx(B,{className:"pt-6",children:e.jsx(L,{mode:"wait",children:e.jsxs(g.form,{initial:{opacity:0,x:t==="signup"?20:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:t==="signup"?-20:20},onSubmit:C,className:"space-y-4",children:[t==="signup"&&e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-3.5 h-5 w-5 text-cyan-500/70"}),e.jsx(x,{type:"text",placeholder:"Display name (optional)",className:"pl-10 h-12 rounded-xl bg-slate-950/50 border-white/10 text-white placeholder:text-slate-500 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all",value:u,onChange:a=>v(a.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-3.5 h-5 w-5 text-cyan-500/70"}),e.jsx(x,{type:"email",placeholder:"email@example.com",className:"pl-10 h-12 rounded-xl bg-slate-950/50 border-white/10 text-white placeholder:text-slate-500 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all",value:o,onChange:a=>j(a.target.value),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-3.5 h-5 w-5 text-cyan-500/70"}),e.jsx(x,{type:d?"text":"password",placeholder:t==="signup"?"Create a password (min 6 chars)":"Password",className:"pl-10 pr-12 h-12 rounded-xl bg-slate-950/50 border-white/10 text-white placeholder:text-slate-500 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all",value:l,onChange:a=>c(a.target.value),required:!0,minLength:6}),e.jsx("button",{type:"button",className:"absolute right-3 top-3.5 text-slate-500 hover:text-slate-300 transition-colors",onClick:()=>N(!d),tabIndex:-1,children:d?e.jsx(Y,{className:"h-5 w-5"}):e.jsx(q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-xl bg-amber-500/10 border border-amber-500/20",children:[e.jsx(J,{className:"h-4 w-4 text-amber-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-amber-200/80 leading-relaxed",children:"OTP (one-time password) login is currently unavailable. Please use email and password to sign in or create an account."})]}),e.jsxs(b,{type:"submit",className:"w-full h-12 rounded-xl text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white shadow-[0_0_20px_rgba(6,182,212,0.3)] hover:shadow-[0_0_30px_rgba(6,182,212,0.5)] transition-all",disabled:i,children:[i&&e.jsx(R,{className:"h-5 w-5 animate-spin mr-2"}),i?t==="signup"?"Creating...":"Signing in...":t==="signup"?"Create Account":"Sign In",!i&&e.jsx(z,{className:"ml-2 h-5 w-5"})]}),e.jsx("p",{className:"text-center text-sm text-slate-400",children:t==="signin"?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{type:"button",className:"text-cyan-400 hover:text-cyan-300 font-medium transition-colors",onClick:()=>{m("signup"),c("")},children:"Sign Up"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{type:"button",className:"text-cyan-400 hover:text-cyan-300 font-medium transition-colors",onClick:()=>{m("signin"),c("")},children:"Sign In"})]})})]},t)})}),e.jsxs(D,{className:"flex flex-col gap-4 pb-8",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-white/10"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-transparent px-2 text-slate-500 font-medium",children:"Or continue with"})})]}),e.jsxs(b,{variant:"outline",className:"w-full h-12 rounded-xl border-white/10 bg-white/5 text-slate-300 hover:bg-white/10 hover:text-white hover:border-white/20 transition-all font-medium",onClick:S,disabled:i,children:[e.jsx(f,{className:"mr-2 h-5 w-5 text-cyan-400"}),"Guest Access"]})]})]}),e.jsx("p",{className:"mt-8 text-center text-xs text-slate-500 px-8",children:"By continuing, you agree to our terms and community guidelines for ocean protection."})]})})}export{Z as default};
