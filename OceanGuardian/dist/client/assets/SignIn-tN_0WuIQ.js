import{k as v,j as e,m,C as j,a as N,b as S,f as C,c as _,Q as E,g as l,h as O}from"./index-BSERnFbJ.js";import{r as o}from"./vendor-DvMla3zT.js";import{I as u}from"./input-COp-znCL.js";import{W as k,a1 as P,E as p,m as T,a2 as I}from"./ui-CRTwZCWL.js";import"./maps-DK6RsE9k.js";function B(){const[n,f]=o.useState(""),[c,g]=o.useState(""),[d,x]=o.useState("email"),[t,r]=o.useState(!1),{toast:a}=v(),w=async s=>{s.preventDefault(),r(!0);try{const i=await fetch("/api/auth/otp/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})});if(i.ok)x("otp"),a({title:"OTP Sent",description:"Check your email for the verification code."});else{const h=await i.json();a({title:"Error",description:h.error||"Failed to send OTP",variant:"destructive"})}}catch{a({title:"Error",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{r(!1)}},y=async s=>{s.preventDefault(),r(!0);try{const i=await fetch("/api/auth/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,otp:c})});if(i.ok)a({title:"Welcome!",description:"You have signed in successfully."}),window.location.href="/";else{const h=await i.json();a({title:"Invalid OTP",description:h.error||"Please check the code and try again.",variant:"destructive"})}}catch{a({title:"Error",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{r(!1)}},b=async()=>{r(!0);try{(await fetch("/api/auth/guest",{method:"POST"})).ok?(a({title:"Guest Session Started",description:"You're now browsing as a guest."}),window.location.href="/"):a({title:"Error",description:"Failed to start guest session.",variant:"destructive"})}catch{a({title:"Error",description:"Something went wrong.",variant:"destructive"})}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12 relative z-10",children:e.jsxs(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 shadow-[0_0_25px_rgba(6,182,212,0.4)] mb-6 animate-float-slow",children:e.jsx(k,{className:"h-10 w-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2 drop-shadow-lg text-center",children:"Welcome Back"}),e.jsx("p",{className:"text-cyan-100/80 text-center text-lg",children:"Guardian"})]}),e.jsxs(j,{className:"bg-slate-900/40 backdrop-blur-xl border-white/10 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs(N,{className:"text-center pb-2",children:[e.jsx(S,{className:"text-xl font-semibold text-white",children:d==="email"?"Sign In":"Verify Email"}),e.jsx(C,{className:"text-slate-400",children:d==="email"?"Enter your email to access your dashboard":`We've sent a code to ${n}`})]}),e.jsx(_,{className:"pt-6",children:e.jsx(E,{mode:"wait",children:d==="email"?e.jsxs(m.form,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},onSubmit:w,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-3.5 h-5 w-5 text-cyan-500/70"}),e.jsx(u,{type:"email",placeholder:"email@example.com",className:"pl-10 h-12 rounded-xl bg-slate-950/50 border-white/10 text-white placeholder:text-slate-500 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all",value:n,onChange:s=>f(s.target.value),required:!0})]})}),e.jsxs(l,{type:"submit",className:"w-full h-12 rounded-xl text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white shadow-[0_0_20px_rgba(6,182,212,0.3)] hover:shadow-[0_0_30px_rgba(6,182,212,0.5)] transition-all",disabled:t,children:[t?e.jsx(p,{className:"h-5 w-5 animate-spin mr-2"}):null,t?"Sending...":"Send Code",!t&&e.jsx(T,{className:"ml-2 h-5 w-5"})]})]},"email-step"):e.jsxs(m.form,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},onSubmit:y,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(u,{type:"text",placeholder:"000000",className:"h-14 text-center text-3xl tracking-[0.5em] rounded-xl bg-slate-950/50 border-white/10 text-white focus:ring-cyan-500/50 focus:border-cyan-500/50 font-mono",value:c,onChange:s=>g(s.target.value.replace(/\D/g,"").slice(0,6)),required:!0,autoFocus:!0})}),e.jsxs(l,{type:"submit",className:"w-full h-12 rounded-xl text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white shadow-[0_0_20px_rgba(6,182,212,0.3)] hover:shadow-[0_0_30px_rgba(6,182,212,0.5)] transition-all",disabled:t||c.length<6,children:[t?e.jsx(p,{className:"h-5 w-5 animate-spin mr-2"}):null,t?"Verifying...":"Sign In"]}),e.jsx(l,{variant:"ghost",type:"button",className:"w-full text-slate-400 hover:text-white hover:bg-white/5",onClick:()=>x("email"),disabled:t,children:"Change Email"})]},"otp-step")})}),e.jsxs(O,{className:"flex flex-col gap-4 pb-8",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-white/10"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-transparent px-2 text-slate-500 font-medium",children:"Or continue with"})})]}),e.jsxs(l,{variant:"outline",className:"w-full h-12 rounded-xl border-white/10 bg-white/5 text-slate-300 hover:bg-white/10 hover:text-white hover:border-white/20 transition-all font-medium",onClick:b,disabled:t,children:[e.jsx(I,{className:"mr-2 h-5 w-5 text-cyan-400"}),"Guest Access"]})]})]}),e.jsx("p",{className:"mt-8 text-center text-xs text-slate-500 px-8",children:"By continuing, you agree to our terms and community guidelines for ocean protection."})]})})}export{B as default};
